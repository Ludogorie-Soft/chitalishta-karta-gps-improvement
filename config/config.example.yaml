# Chitalishta Geocoder Configuration (Example)
# Copy this file to config.yaml and fill in your actual values

# Database connection
db:
  # Connection string for PostgreSQL with PostGIS
  url: "postgresql+psycopg2://postgres:postgres@localhost:5436/chitalishta_maps"

# Google Geocoding API
google:
  # Get your API key from: https://console.cloud.google.com/apis/credentials
  api_key: "YOUR_GOOGLE_API_KEY_HERE"

# Nominatim (OpenStreetMap) settings
nominatim:
  # Base URL for Nominatim API
  base_url: "https://nominatim.openstreetmap.org/search"
  
  # User-Agent is REQUIRED by Nominatim usage policy
  # Format: "app-name/version (contact-email)"
  user_agent: "chitalishta-geocoder/1.0 (your-email@example.com)"
  
  # Rate limiting: 1 request per second (Nominatim policy)
  rate_limit_seconds: 1.0
  
  # Big cities optimization
  # For major cities with detailed street-level data in OpenStreetMap,
  # free-form queries with full address work better than structured queries
  big_cities:
    - "ГРАД СОФИЯ"
    - "ГРАД ПЛОВДИВ"
    - "ГРАД ВАРНА"
    - "ГРАД БУРГАС"
  
  # Strategy for big cities geocoding
  big_city_strategy:
    # Try free-form query with full address FIRST (instead of structured query)
    # This includes the street address in the query, giving better results
    use_freeform_first: true
    
    # Minimum confidence threshold for accepting free-form results
    # Lower than standard (60) because street-level results are valuable
    min_confidence_for_freeform: 40
    
    # Result validation settings
    validate_settlement_match: true      # Verify result is from expected city
    prefer_building_results: true        # Prefer building/highway over administrative
    reject_administrative_only: true     # Don't accept city center as final result
    
    # How many top results to check when validating (for future enhancement)
    max_results_to_check: 3
    
    # Fallback behavior if free-form query fails or is rejected
    fallback_to_structured: true         # Try structured query as fallback

# Distance thresholds (in meters)
thresholds:
  # Distance threshold for considering result "OK"
  # If geocoded point is within this distance from source, it's good
  ok_distance_m: 1000
  
  # Distance threshold for suspicious results
  # Beyond this distance, result is marked as "mismatch"
  suspicious_distance_m: 5000
  
  # Minimum confidence score to accept a result without review
  # Scale: 0-100
  min_confidence: 60

